<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:th="http://www.thymeleaf.org">
<head th:replace="~{requestmodule/fragments/header :: header(datatables = true)}"></head>
<body class="top-navigation layout-fixed">
<div id="wrapper">
	<div id="page-wrapper" class="gray-bg">
		<div th:replace="~{requestmodule/fragments/topbar :: topbar(page = 'requestlog')}"></div>
		<div class="wrapper wrapper-content">
			<div class="row">
				<div class="col-lg-12">
					<div class="ibox">
						<div class="ibox-title">
							<h3>
								<em class="fa fa-list"></em> &nbsp
								<span th:text="#{requestmodule.topbar.log}"></span>
							</h3>



							<div class="ibox-tools">
								<a th:href="@{/ui/request/requestlog/download}" class="btn btn-primary btn-lg">
									<em class="fa fa-fw fa-download"></em> &nbsp;
									<span th:text="#{html.word.download}"></span>
								</a>
							</div>
						</div>


						<div class="ibox-content">
							<div class="table-responsive">
								<table id="requestLogTable" class="table table-striped table-bordered table-hover">
									<thead>
									<tr>
										<th class="col-1" th:text="#{requestmodule.html.log.table.header.timestamp}"></th>
										<th class="col-2" th:text="#{requestmodule.html.log.table.header.actinguser}"></th>
										<th class="col-2" th:text="#{requestmodule.html.log.table.header.affecteduser}"></th>
										<th class="col-2" th:text="#{requestmodule.html.log.table.header.action}"></th>
										<th class="col-2" th:text="#{requestmodule.html.log.table.header.rolename}"></th>
										<th class="col-1" th:text="#{requestmodule.html.log.table.header.itsystem}"></th>
										<th class="" th:text="#{requestmodule.html.log.table.header.details}"></th>
									</tr>
									</thead>
									<tbody>
									<tr th:each="entry : ${requestLogs}" th:object="${entry}">
										<td th:text="${#temporals.format(entry.eventTimestamp, 'dd-MM-yyyy HH:mm')}"></td>
										<td th:text="*{actingUserName}"></td>
										<td th:text="*{targetUserName}"></td>
										<td th:text="#{*{action}}"></td>
										<td th:text="*{roleName}"></td>
										<td th:text="*{itsystem}"></td>
										<td th:text="*{details}">

										</td>
									</tr>
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<div th:replace="~{requestmodule/fragments/footer :: scripts(datatables = true)}"></div>
<script th:src="@{/js/rolerequest/requestLog/logs.js}"></script>

<script th:inline="javascript">
	/*<![CDATA[*/
	/*[+
		const detailsUrl = [[@{/ui/request/log}]];
		const restUrl = [[@{/rest/rolerequest/log}]];
		const token = $("meta[name='_csrf']").attr("content");
		let logTableService
	+]*/

	$(document).ready(function(){
		logTableService = new RequestLogService()
	});

	/*]]>*/
</script>

</body>
</html>
